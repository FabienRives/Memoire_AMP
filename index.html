<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carte Leaflet avec GeoJSON et Menu</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
  
</head>
<body>
  <!-- Overlay de chargement -->
  <div id="loading-overlay">
    <div class="spinner"></div>
    <p>Chargement en cours...</p>
  </div>

  <div id="mapContainer">
    
    <div id="menu">
      <h3>Fond cartographique</h3>
      <div id="basemap-selector">
        <label>
          <input type="radio" name="basemap" value="osm" checked> 
          <i class="fas fa-map"></i> Carte standard (OpenStreetMap)
        </label>

        <label>
          <input type="radio" name="basemap" value="satellite"> 
          <i class="fas fa-satellite"></i> Vue satellite (Esri)
        </label>
      </div>
      <hr>
      <h3>Couches disponibles</h3>
      <ul id="layer-list">
        <!-- Communes AMP (activée au chargement) -->
        <li class="menu-item" data-layer="communes">
          <span class="drag-handle"><i class="fas fa-grip-lines"></i></span>
          <input type="checkbox" id="layer-communes" checked>
          <label for="layer-communes">
            <i class="fas fa-layer-group"></i> Communes AMP
          </label>
          <input type="color" id="color-communes" value="#28a745" title="Couleur Communes">
        </li>
        <!-- EPCI AMP -->
        <li class="menu-item" data-layer="epci">
          <span class="drag-handle"><i class="fas fa-grip-lines"></i></span>
          <input type="checkbox" id="layer-epci">
          <label for="layer-epci">
            <i class="fas fa-layer-group"></i> EPCI AMP
          </label>
          <input type="color" id="color-epci" value="#0078ff" title="Couleur EPCI">
        </li>
        <!-- Gisement Foncier -->
        <li class="menu-item" data-layer="gisement">
          <span class="drag-handle"><i class="fas fa-grip-lines"></i></span>
          <input type="checkbox" id="layer-gisement">
          <label for="layer-gisement">
            <i class="fas fa-layer-group"></i> Gisement Foncier
          </label>
          <input type="color" id="color-gisement" value="#ff7800" title="Couleur Gisement">
        </li>
        <!-- Propriétaires Moraux (diagramme secteur) -->
        <li class="menu-item" data-layer="moraux">
          <span class="drag-handle"><i class="fas fa-grip-lines"></i></span>
          <input type="checkbox" id="layer-moraux">
          <label for="layer-moraux">
            <i class="fas fa-chart-pie"></i> Propriétaires Moraux
          </label>
          <input type="color" id="color-moraux" value="#000000" title="Couleur Moraux">
        </li>
      </ul>
    </div>
    <div id="map">
      <!-- Barre de recherche sur la carte -->
      <div id="search-box">
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input type="text" id="commune-search" placeholder="Rechercher une commune dans la métropole..." autocomplete="off">
          <div id="search-results"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
  <!-- Ajout de Chart.js pour les diagrammes secteur -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js"></script>
</body>
</html>